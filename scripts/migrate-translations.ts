import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

async function migrateAndSeedTranslations() {
  console.log("üîÑ Migrating existing products and seeding translations...");

  // First, clear existing products to start fresh
  await prisma.productTranslation.deleteMany();
  await prisma.product.deleteMany();

  const productsWithTranslations = [
    {
      slug: "classic-sofa",
      price: 499,
      originalPrice: 599,
      images: ["/images/business-slide1.jpg", "/images/business-slide2.jpg", "/images/business-slide3.jpg"],
      room: "Living Room",
      type: "Sofa",
      combo: "Living Room Set",
      category: "Living Room Furniture",
      inStock: true,
      featured: true,
      specifications: {
        en: {
          "Dimensions": "210cm W x 90cm D x 85cm H",
          "Materials": "Hardwood frame, Premium fabric upholstery",
          "Color Options": "Beige, Gray, Navy Blue",
          "Weight": "65kg",
          "Assembly": "Professional assembly recommended",
          "Warranty": "5 years structural, 2 years fabric"
        },
        vi: {
          "K√≠ch th∆∞·ªõc": "210cm R x 90cm S x 85cm C",
          "V·∫≠t li·ªáu": "Khung g·ªó c·ª©ng, V·∫£i b·ªçc cao c·∫•p",
          "T√πy ch·ªçn m√†u": "Be, X√°m, Xanh navy",
          "Tr·ªçng l∆∞·ª£ng": "65kg",
          "L·∫Øp ƒë·∫∑t": "Khuy·∫øn ngh·ªã l·∫Øp ƒë·∫∑t chuy√™n nghi·ªáp",
          "B·∫£o h√†nh": "5 nƒÉm k·∫øt c·∫•u, 2 nƒÉm v·∫£i"
        }
      },
      features: {
        en: [
          "Handcrafted hardwood frame",
          "Premium fabric upholstery",
          "High-density foam cushions",
          "Removable cushion covers",
          "Professional assembly available",
          "5-year structural warranty"
        ],
        vi: [
          "Khung g·ªó c·ª©ng th·ªß c√¥ng",
          "V·∫£i b·ªçc cao c·∫•p",
          "ƒê·ªám foam m·∫≠t ƒë·ªô cao",
          "V·ªè ƒë·ªám c√≥ th·ªÉ th√°o r·ªùi",
          "C√≥ d·ªãch v·ª• l·∫Øp ƒë·∫∑t chuy√™n nghi·ªáp",
          "B·∫£o h√†nh k·∫øt c·∫•u 5 nƒÉm"
        ]
      },
      translations: {
        en: {
          name: "Classic Sofa",
          description: "A timeless classic sofa that brings comfort and elegance to your living space.",
          longDescription: "Our Classic Sofa represents the perfect blend of traditional craftsmanship and modern comfort. Each piece is meticulously handcrafted using sustainably sourced hardwood frames and premium upholstery materials.",
          metaTitle: "Classic Sofa - Comfortable Living Room Furniture",
          metaDescription: "Premium handcrafted sofa with hardwood frame and luxury upholstery."
        },
        vi: {
          name: "Sofa C·ªï ƒêi·ªÉn",
          description: "M·ªôt chi·∫øc sofa c·ªï ƒëi·ªÉn v∆∞·ª£t th·ªùi gian mang ƒë·∫øn s·ª± tho·∫£i m√°i v√† thanh l·ªãch cho kh√¥ng gian s·ªëng c·ªßa b·∫°n.",
          longDescription: "Sofa C·ªï ƒêi·ªÉn c·ªßa ch√∫ng t√¥i th·ªÉ hi·ªán s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa ngh·ªÅ th·ªß c√¥ng truy·ªÅn th·ªëng v√† s·ª± tho·∫£i m√°i hi·ªán ƒë·∫°i. M·ªói s·∫£n ph·∫©m ƒë∆∞·ª£c ch·∫ø t√°c t·ªâ m·ªâ b·∫±ng khung g·ªó c·ª©ng b·ªÅn v·ªØng v√† v·∫≠t li·ªáu b·ªçc cao c·∫•p.",
          metaTitle: "Sofa C·ªï ƒêi·ªÉn - N·ªôi Th·∫•t Ph√≤ng Kh√°ch Tho·∫£i M√°i",
          metaDescription: "Sofa th·ªß c√¥ng cao c·∫•p v·ªõi khung g·ªó c·ª©ng v√† v·∫£i b·ªçc sang tr·ªçng."
        }
      }
    },
    {
      slug: "modern-bed",
      price: 799,
      originalPrice: 899,
      images: ["/images/business-slide2.jpg", "/images/business-slide1.jpg", "/images/business-slide3.jpg"],
      room: "Bedroom",
      type: "Bed",
      combo: "Bedroom Combo",
      category: "Bedroom Furniture",
      inStock: true,
      featured: true,
      specifications: {
        en: {
          "Dimensions": "160cm W x 200cm L x 120cm H",
          "Materials": "Solid wood frame, Upholstered headboard",
          "Size Options": "Queen, King",
          "Weight": "45kg",
          "Assembly": "Required (tools included)",
          "Warranty": "10 years frame, 3 years upholstery"
        },
        vi: {
          "K√≠ch th∆∞·ªõc": "160cm R x 200cm D x 120cm C",
          "V·∫≠t li·ªáu": "Khung g·ªó nguy√™n kh·ªëi, ƒê·∫ßu gi∆∞·ªùng b·ªçc v·∫£i",
          "T√πy ch·ªçn k√≠ch c·ª°": "Queen, King",
          "Tr·ªçng l∆∞·ª£ng": "45kg",
          "L·∫Øp ƒë·∫∑t": "C·∫ßn l·∫Øp ƒë·∫∑t (c√≥ k√®m d·ª•ng c·ª•)",
          "B·∫£o h√†nh": "10 nƒÉm khung, 3 nƒÉm v·∫£i b·ªçc"
        }
      },
      features: {
        en: [
          "Solid wood construction",
          "Upholstered headboard",
          "Platform design (no box spring needed)",
          "Under-bed storage space",
          "Easy assembly",
          "10-year frame warranty"
        ],
        vi: [
          "K·∫øt c·∫•u g·ªó nguy√™n kh·ªëi",
          "ƒê·∫ßu gi∆∞·ªùng b·ªçc v·∫£i",
          "Thi·∫øt k·∫ø platform (kh√¥ng c·∫ßn ƒë·ªám l√≤ xo)",
          "Khoang ch·ª©a ƒë·ªì d∆∞·ªõi g·∫ßm",
          "L·∫Øp ƒë·∫∑t d·ªÖ d√†ng",
          "B·∫£o h√†nh khung 10 nƒÉm"
        ]
      },
      translations: {
        en: {
          name: "Modern Bed",
          description: "Contemporary bed frame with sleek design and superior comfort for a perfect night's sleep.",
          longDescription: "The Modern Bed features a minimalist design that brings contemporary elegance to your bedroom. Built with solid wood construction and upholstered headboard for ultimate comfort and style.",
          metaTitle: "Modern Bed - Contemporary Bedroom Furniture",
          metaDescription: "Stylish platform bed with solid wood construction and upholstered headboard."
        },
        vi: {
          name: "Gi∆∞·ªùng Hi·ªán ƒê·∫°i",
          description: "Khung gi∆∞·ªùng hi·ªán ƒë·∫°i v·ªõi thi·∫øt k·∫ø b√≥ng b·∫©y v√† s·ª± tho·∫£i m√°i v∆∞·ª£t tr·ªôi cho gi·∫•c ng·ªß ho√†n h·∫£o.",
          longDescription: "Gi∆∞·ªùng Hi·ªán ƒê·∫°i c√≥ thi·∫øt k·∫ø t·ªëi gi·∫£n mang ƒë·∫øn v·∫ª thanh l·ªãch ƒë∆∞∆°ng ƒë·∫°i cho ph√≤ng ng·ªß c·ªßa b·∫°n. ƒê∆∞·ª£c ch·∫ø t√°c t·ª´ g·ªó nguy√™n kh·ªëi v√† ƒë·∫ßu gi∆∞·ªùng b·ªçc v·∫£i ƒë·ªÉ c√≥ s·ª± tho·∫£i m√°i v√† phong c√°ch t·ªëi ∆∞u.",
          metaTitle: "Gi∆∞·ªùng Hi·ªán ƒê·∫°i - N·ªôi Th·∫•t Ph√≤ng Ng·ªß ƒê∆∞∆°ng ƒê·∫°i",
          metaDescription: "Gi∆∞·ªùng platform phong c√°ch v·ªõi k·∫øt c·∫•u g·ªó nguy√™n kh·ªëi v√† ƒë·∫ßu gi∆∞·ªùng b·ªçc v·∫£i."
        }
      }
    },
    {
      slug: "dining-table",
      price: 599,
      images: ["/images/business-slide3.jpg", "/images/business-slide1.jpg"],
      room: "Kitchen",
      type: "Table",
      combo: "Dining Set",
      category: "Dining Room Furniture",
      inStock: true,
      featured: false,
      specifications: {
        en: {
          "Dimensions": "180cm W x 90cm D x 75cm H",
          "Materials": "Solid wood",
          "Seating Capacity": "6-8 people",
          "Weight": "35kg",
          "Assembly": "Minimal assembly required",
          "Warranty": "5 years"
        },
        vi: {
          "K√≠ch th∆∞·ªõc": "180cm R x 90cm S x 75cm C",
          "V·∫≠t li·ªáu": "G·ªó nguy√™n kh·ªëi",
          "S·ª©c ch·ª©a": "6-8 ng∆∞·ªùi",
          "Tr·ªçng l∆∞·ª£ng": "35kg",
          "L·∫Øp ƒë·∫∑t": "C·∫ßn l·∫Øp ƒë·∫∑t t·ªëi thi·ªÉu",
          "B·∫£o h√†nh": "5 nƒÉm"
        }
      },
      features: {
        en: [
          "Solid wood construction",
          "Seats 6-8 people comfortably",
          "Scratch-resistant finish",
          "Easy to clean surface",
          "Classic design"
        ],
        vi: [
          "K·∫øt c·∫•u g·ªó nguy√™n kh·ªëi",
          "Ch·ªó ng·ªìi tho·∫£i m√°i cho 6-8 ng∆∞·ªùi",
          "B·ªÅ m·∫∑t ch·ªëng tr·∫ßy x∆∞·ªõc",
          "B·ªÅ m·∫∑t d·ªÖ v·ªá sinh",
          "Thi·∫øt k·∫ø c·ªï ƒëi·ªÉn"
        ]
      },
      translations: {
        en: {
          name: "Dining Table",
          description: "Elegant dining table perfect for family meals and entertaining guests.",
          longDescription: "This dining table combines functionality with style, featuring a robust construction that can accommodate family gatherings and dinner parties with ease.",
          metaTitle: "Dining Table - Elegant Kitchen Furniture",
          metaDescription: "Spacious dining table that seats 6-8 people, perfect for family meals."
        },
        vi: {
          name: "B√†n ƒÇn",
          description: "B√†n ƒÉn thanh l·ªãch ho√†n h·∫£o cho b·ªØa ƒÉn gia ƒë√¨nh v√† ti·∫øp kh√°ch.",
          longDescription: "Chi·∫øc b√†n ƒÉn n√†y k·∫øt h·ª£p ch·ª©c nƒÉng v·ªõi phong c√°ch, c√≥ k·∫øt c·∫•u ch·∫Øc ch·∫Øn c√≥ th·ªÉ ph·ª•c v·ª• c√°c bu·ªïi t·ª• h·ªçp gia ƒë√¨nh v√† ti·ªác t·ªëi m·ªôt c√°ch d·ªÖ d√†ng.",
          metaTitle: "B√†n ƒÇn - N·ªôi Th·∫•t B·∫øp Thanh L·ªãch",
          metaDescription: "B√†n ƒÉn r·ªông r√£i ch·ªó ng·ªìi cho 6-8 ng∆∞·ªùi, ho√†n h·∫£o cho b·ªØa ƒÉn gia ƒë√¨nh."
        }
      }
    }
  ];

  for (const productData of productsWithTranslations) {
    // Create the main product
    const product = await prisma.product.create({
      data: {
        slug: productData.slug,
        price: productData.price,
        originalPrice: productData.originalPrice,
        images: productData.images,
        room: productData.room,
        type: productData.type,
        combo: productData.combo,
        category: productData.category,
        inStock: productData.inStock,
        featured: productData.featured,
        specifications: productData.specifications,
        features: productData.features,
      },
    });

    // Create translations for each locale
    for (const [locale, translation] of Object.entries(productData.translations)) {
      await prisma.productTranslation.create({
        data: {
          productId: product.id,
          locale,
          name: translation.name,
          description: translation.description,
          longDescription: translation.longDescription,
          metaTitle: translation.metaTitle,
          metaDescription: translation.metaDescription,
        },
      });
    }

    console.log(`‚úÖ Created product: ${productData.translations.en.name} with translations`);
  }

  console.log("üéâ Migration and seeding completed!");
}

migrateAndSeedTranslations()
  .catch((e) => {
    console.error("‚ùå Error:", e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
